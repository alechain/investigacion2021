knitr::opts_chunk$set(echo = TRUE)
ephi<- get_microdata(year=2018:2019, trimester = 1:4, type = "individual")
library(eph)
install.packages("eph")
knitr::opts_chunk$set(echo = TRUE)
library(eph)
install.packages("eph")
rm(list=ls())
knitr::opts_chunk$set(echo = TRUE)
library(eph)
ephi<- get_microdata(year=2018:2019, trimester = 1:4, type = "individual")
unlist(ephi)
View(ephi)
ephi<- ephi %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
View(ephi)
table(ephi$TRIMESTRE, ephi$ANO4)
ephi<- get_microdata(year=2016:2019, trimester = 1:4, type = "individual")
ephi<- get_microdata(year=2017:2019, trimester = 1:4, type = "individual")
ephi<- ephi %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
table(ephi$TRIMESTRE, ephi$ANO4)
ephi2<- get_microdata(year=2016, trimester = 2:4, type = "individual")
ephi2<- ephi2 %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
table(ephi2$TRIMESTRE, ephi2$ANO4)
ephi<- bind_rows(ephi,ephi2)
library(tidyverse)
ephi<- bind_rows(ephi,ephi2)
View(ephi)
ephi<- ephi %>% arrange(c("ANO4", "TRIMESTRE"))
ephi<- ephi %>% arrange(-ANO4)
?arrange
ephi<- ephi %>% arrange(-ANO4, TRIMESTRE)
ephi<- ephi %>% arrange(-ANO4, -TRIMESTRE)
?arrange
table(ephi$TRIMESTRE, ephi$ANO4)
## Hogar
ephh<- get_microdata(year=2017:2019, trimester = 1:4, type = "hogar")
ephh<- ephh %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
### 2016
ephh2<- get_microdata(year=2016, trimester = 2:4, type = "hogar")
ephh2<- ephh2 %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
ephh<- bind_rows(ephh,ephh2)
ephh<- ephi %>% arrange(-ANO4, -TRIMESTRE)
ephh<- get_microdata(year=2017:2019, trimester = 1:4, type = "hogar")
ephh<- ephh %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
ephh2<- get_microdata(year=2016, trimester = 2:4, type = "hogar")
ephh2<- ephh2 %>%
dplyr::select(microdata) %>%
tidyr::unnest(cols = c(microdata))
ephh<- bind_rows(ephh,ephh2)
ephh<- ephh %>% arrange(-ANO4, -TRIMESTRE)
ephtotal<- left_join(ephi,ephh)
install.packages("readxl")
library(readxl)
### aglomerado
aglomerado<- read_excel("aglomerado.xlsx",sheet = 4)
View(aglomerado)
ephtotal<- left_join(ephtotal,aglomerado)
knitr::opts_chunk$set(echo = TRUE)
library(eph)
library(tidyverse)
library(readxl)
ephtotal<- left_join(ephtotal,aglomerado)
table(ephtotal$CH15_COD)
ephinmi<- ephtotal %>% filter(CH15==3)
table(ephtotal$CH15_COD)
table(ephinmi$CH15_COD)
ephinmi<- ephtotal %>% filter(CH15==3) %>% select(CH15_COD)
View(ephinmi)
table(ephinmi$CH15_COD)
ephinmi<- ephtotal %>% filter(CH15==3)
provincia<- read.csv("provincias.csv", sep=",", header = T)
View(provincia)
ephinmi<- left_join(ephinmi, provincia)
ephinmi %>% group_by(PROVINCIA) %>% summarise(total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA))
install.packages("formattaable")
install.packages("formattable")
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2)) %>% arrange(-total_inmigrantes)
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2)) %>% arrange(-total_migrantes)
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
ephinmi<- ephtotal %>% filter(CH15==3)
ephinmi<- left_join(ephinmi, provincia)
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
table(ephinmi$CH15, ephinmi$CH15_COD)
table(ephinmi$CH15, ephinmi$PROVINCIA)
View(ephinmi)
prueba<- ephinmi %>% select(CH15, CH15_COD, PROVINCIA)
View(prueba)
View(provincia)
ephinmi<- ephtotal %>% filter(CH15==3)
ephinmi<- left_join(ephinmi, provincia)
provincia<- provincia %>% select(PROVINCIA,CH15_COD)
ephinmi<- ephtotal %>% filter(CH15==3)
ephinmi<- left_join(ephinmi, provincia)
prueba<- ephinmi %>% select(CH15, CH15_COD, PROVINCIA)
ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
prueba<- ephinmi %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
View(prueba)
prueba<- ephinmi %>% filter(is.na(provincia))
prueba<- ephinmi %>% filter(is.na(PROVINCIA))
prueba<- prueba %>% select(CH15, CH15_COD, PROVINCIA)
prueba<- ephinmi %>% filter(!is.na(PROVINCIA)) %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA)),2))
provincia<- read.csv("provincias.csv", sep=",", header = T)
provincia1<- provincia %>% select(PROVINCIA,CH15_COD)
provincia2<- provincia %>% select(PROVINCIA,CH16_COD)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
prueba<- ephnuevoinmi %>% filter(is.na(PROVINCIA))
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
prueba<- ephnuevoinmi %>% filter(is.na(PROVINCIA))
prueba<- prueba %>% select(CH15, CH15_COD, PROVINCIA)
prueba<- ephnuevoinmi %>% filter(is.na(PROVINCIA))
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
prueba<- ephnuevoinmi %>% filter(is.na(PROVINCIA))
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
prueba<- ephnuevoinmi %>% filter(is.na(PROVINCIA))
prueba<- prueba %>% filter(!is.na(PROVINCIA)) %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(prueba$PONDERA)),2))
ephnuevoinmi<- ephtotal %>% filter(CH16==3)
ephnuevoinmi<- left_join(ephnuevoinmi, provincia2)
prueba<- ephnuevoinmi %>% filter(!is.na(PROVINCIA))
prueba<- prueba %>% filter(!is.na(PROVINCIA)) %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(prueba$PONDERA)),2))
View(prueba)
prueba<- ephinmi %>% filter(!is.na(PROVINCIA)) %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA[!is.na(PROVINCIA)])),2))
prueba2<- ephinmi %>% filter(!is.na(PROVINCIA) & CH06>=18) %>% group_by(PROVINCIA) %>% summarise(formattable::percent((total_migrantes=sum(PONDERA)/sum(ephinmi$PONDERA[!is.na(PROVINCIA) & CH06>=18])),2))
View(prueba2)
prueba<- ephinmi %>% select(CH15, CH15_COD, PROVINCIA)
table(ephinmi$AGLOMERADO2)
prueba3<- ephinmi %>% filter(!is.na(PROVINCIA) & CH06>=18) %>% group_by(AGLOMERADO2) %>%
summarise(formattable::percent((sum(PONDERA)/sum(ephinim$PONDERA[!is.na(PROVINCIA) & CH06>=18]))))
prueba3<- ephinmi %>% filter(!is.na(PROVINCIA) & CH06>=18) %>% group_by(AGLOMERADO2) %>%
summarise(formattable::percent((sum(PONDERA)/sum(ephinim$PONDERA[!is.na(PROVINCIA) & CH06>=18])),2))
prueba3<- ephinmi %>% filter(!is.na(PROVINCIA) & CH06>=18) %>% group_by(AGLOMERADO2) %>%
summarise(sum(PONDERA))
View(prueba3)
rm(list=ls())
